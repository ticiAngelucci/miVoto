# miVoto - proyecto  arquitectura

Documentaci贸n de la Base de Datos H铆brida para Sistema de Votaci贸nEsta documentaci贸n describe la arquitectura de datos del proyecto, que utiliza Cloud Firestore (Centralizado) para la gesti贸n de identidad y control, y la Blockchain (Descentralizado) para el registro an贸nimo e inmutable de votos.I. Arquitectura y PrincipiosPrincipioComponente ResponsableDescripci贸nIdentidadFirebase Authentication / Colecci贸n votantesGestiona el login y el padr贸n electoral (qui茅n puede votar).AnonimatoBlockchain (Contrato Inteligente)Garantiza que el voto real (por qui茅n se vota) no pueda vincularse a la identidad del votante.IntegridadColecci贸n votos_emitidos / BlockchainLa colecci贸n previene el doble voto. La Blockchain asegura que el voto no pueda ser alterado.Conexi贸nCampo contrato_addressUne la configuraci贸n de la elecci贸n centralizada con el Smart Contract descentralizado.II. Colecciones de Cloud Firestore (Capas Centralizadas)1. Colecci贸n: votantes (Padr贸n e Identidad) Prop贸sito: Almacenar la informaci贸n personal y el estado de elegibilidad de los votantes.CampoTipoRequisitoDescripci贸nDocument IDStringUID de Firebase AuthIdentificador 煤nico del usuario, obtenido de la autenticaci贸n. Clave primaria.nombreStringObligatorioNombre completo del votante.dniStringnicoDocumento de identidad (clave para auditor铆as externas del padr贸n).emailStringnicoCorreo electr贸nico de contacto.esta_habilitadoBooleanObligatorioControl Maestro de Elegibilidad. true = puede votar. false = acceso denegado al proceso de votaci贸n.rolStringOpcionalRol del usuario en el sistema (ej: "votante", "admin").2. Colecci贸n: elecciones (Metadatos y Conexi贸n) 筹Prop贸sito: Definir los par谩metros de cada evento de votaci贸n y establecer el puente a la Blockchain.CampoTipoRequisitoDescripci贸nDocument IDStringID Descriptivo (Slug)Ej: rector-2025-mayo. Clave para identificar la elecci贸n.tituloStringObligatorioT铆tulo oficial de la elecci贸n.fecha_inicioTimestampObligatorioFecha y hora en que la votaci贸n comienza (en UTC).fecha_finTimestampObligatorioFecha y hora en que la votaci贸n termina (en UTC).estadoStringIndexadoEstado actual: 'PENDIENTE', 'ACTIVA', 'FINALIZADA'.contrato_addressStringCRUCIALDirecci贸n del Contrato Inteligente en la red Blockchain (ej. Ethereum/Polygon). FastAPI usa esta direcci贸n para enviar el voto an贸nimo.candidatosArray / MapObligatorioLista de opciones votables (ej. [{"id": 1, "nombre": "Propuesta A"}, ...]).3. Colecci贸n: votos_emitidos (Control de Doble Voto) Prop贸sito: Prevenir el doble voto y registrar la prueba criptogr谩fica de participaci贸n, sin almacenar el voto real.CampoTipoRequisitoDescripci贸nDocument IDStringClave CompuestaConcatenaci贸n de: votante_id + _ + eleccion_id. Garantiza la restricci贸n de unicidad (no puede haber dos votos del mismo votante en la misma elecci贸n).votante_idStringObligatorioEl UID del votante.eleccion_idStringObligatorioEl ID de la elecci贸n.tx_hashStringObligatorioHash de la Transacci贸n de la Blockchain. Prueba inmutable y auditable de que el voto fue enviado y aceptado por el Contrato Inteligente.timestamp_votoTimestampObligatorioFecha y hora en que la transacci贸n fue confirmada.III. Capa Descentralizada: BlockchainEl Contrato Inteligente (ubicado en el contrato_address) contiene la 煤nica fuente de verdad sobre el conteo de votos.Entrada de Voto: Solo acepta la opci贸n votada (ej. optionId: 1) y la firma de la clave del backend de FastAPI. Nunca acepta el UID del votante.Almacenamiento: Mantiene un registro interno (un mapping) para contar el total de votos por opci贸n de forma an贸nima.Resultados: Expone una funci贸n para que cualquier auditor pueda ver los resultados consolidados.Conclusi贸n del Flujo:FastAPI usa la identidad centralizada (votantes) para dar acceso.FastAPI usa la contrato_address para enviar el voto an贸nimo.FastAPI usa el tx_hash para marcar al votante como "particip贸" en el registro centralizado (votos_emitidos).
