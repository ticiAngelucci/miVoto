# miVoto - proyecto  arquitectura

Documentación de la Base de Datos Híbrida para Sistema de VotaciónEsta documentación describe la arquitectura de datos del proyecto, que utiliza Cloud Firestore (Centralizado) para la gestión de identidad y control, y la Blockchain (Descentralizado) para el registro anónimo e inmutable de votos.I. Arquitectura y PrincipiosPrincipioComponente ResponsableDescripciónIdentidadFirebase Authentication / Colección votantesGestiona el login y el padrón electoral (quién puede votar).AnonimatoBlockchain (Contrato Inteligente)Garantiza que el voto real (por quién se vota) no pueda vincularse a la identidad del votante.IntegridadColección votos_emitidos / BlockchainLa colección previene el doble voto. La Blockchain asegura que el voto no pueda ser alterado.ConexiónCampo contrato_addressUne la configuración de la elección centralizada con el Smart Contract descentralizado.II. Colecciones de Cloud Firestore (Capas Centralizadas)1. Colección: votantes (Padrón e Identidad) 👤Propósito: Almacenar la información personal y el estado de elegibilidad de los votantes.CampoTipoRequisitoDescripciónDocument IDStringUID de Firebase AuthIdentificador único del usuario, obtenido de la autenticación. Clave primaria.nombreStringObligatorioNombre completo del votante.dniStringÚnicoDocumento de identidad (clave para auditorías externas del padrón).emailStringÚnicoCorreo electrónico de contacto.esta_habilitadoBooleanObligatorioControl Maestro de Elegibilidad. true = puede votar. false = acceso denegado al proceso de votación.rolStringOpcionalRol del usuario en el sistema (ej: "votante", "admin").2. Colección: elecciones (Metadatos y Conexión) 🗳️Propósito: Definir los parámetros de cada evento de votación y establecer el puente a la Blockchain.CampoTipoRequisitoDescripciónDocument IDStringID Descriptivo (Slug)Ej: rector-2025-mayo. Clave para identificar la elección.tituloStringObligatorioTítulo oficial de la elección.fecha_inicioTimestampObligatorioFecha y hora en que la votación comienza (en UTC).fecha_finTimestampObligatorioFecha y hora en que la votación termina (en UTC).estadoStringIndexadoEstado actual: 'PENDIENTE', 'ACTIVA', 'FINALIZADA'.contrato_addressStringCRUCIALDirección del Contrato Inteligente en la red Blockchain (ej. Ethereum/Polygon). FastAPI usa esta dirección para enviar el voto anónimo.candidatosArray / MapObligatorioLista de opciones votables (ej. [{"id": 1, "nombre": "Propuesta A"}, ...]).3. Colección: votos_emitidos (Control de Doble Voto) 📜Propósito: Prevenir el doble voto y registrar la prueba criptográfica de participación, sin almacenar el voto real.CampoTipoRequisitoDescripciónDocument IDStringClave CompuestaConcatenación de: votante_id + _ + eleccion_id. Garantiza la restricción de unicidad (no puede haber dos votos del mismo votante en la misma elección).votante_idStringObligatorioEl UID del votante.eleccion_idStringObligatorioEl ID de la elección.tx_hashStringObligatorioHash de la Transacción de la Blockchain. Prueba inmutable y auditable de que el voto fue enviado y aceptado por el Contrato Inteligente.timestamp_votoTimestampObligatorioFecha y hora en que la transacción fue confirmada.III. Capa Descentralizada: BlockchainEl Contrato Inteligente (ubicado en el contrato_address) contiene la única fuente de verdad sobre el conteo de votos.Entrada de Voto: Solo acepta la opción votada (ej. optionId: 1) y la firma de la clave del backend de FastAPI. Nunca acepta el UID del votante.Almacenamiento: Mantiene un registro interno (un mapping) para contar el total de votos por opción de forma anónima.Resultados: Expone una función para que cualquier auditor pueda ver los resultados consolidados.Conclusión del Flujo:FastAPI usa la identidad centralizada (votantes) para dar acceso.FastAPI usa la contrato_address para enviar el voto anónimo.FastAPI usa el tx_hash para marcar al votante como "participó" en el registro centralizado (votos_emitidos).
